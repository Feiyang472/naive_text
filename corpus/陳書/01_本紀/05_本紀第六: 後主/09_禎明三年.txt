三年春正月乙丑朔，霧氣四塞。是日，隋總管賀若弼自北道廣陵濟京口，總管韓擒虎趨橫江，[26]濟採石，自南道將會弼軍。景寅，採石戍主徐子建馳啟告變。丁卯，召公卿入議軍旅。戊辰，內外戒嚴，以驃騎將軍蕭摩訶、[27]護軍將軍樊毅、中領軍魯廣達並為都督，遣南豫州刺史樊猛帥舟師出白下，散騎常侍皋文奏將兵鎮南豫州。庚午，賀若弼攻陷南徐州。辛未，韓擒虎又陷南豫州，文奏敗還。至是隋軍南北道並進。後主遣驃騎大將軍、司徒豫章王叔英屯朝（室）〔堂〕，[28]蕭摩訶屯樂遊苑，樊毅屯耆闍寺，魯廣達屯白土岡，忠武將軍孔範屯寶田寺。己卯，鎮東大將軍任忠自吳興入赴，仍屯朱雀門。辛巳，賀若弼進據鍾山，頓白土岡之東南。甲申，後主遣眾軍與弼合戰，眾軍敗績。弼乘勝至樂遊苑，魯廣達猶督散兵力戰，不能拒。弼進攻宮城，燒北掖門。是時韓擒虎率眾自新林至于石子岡，任忠出降於擒虎，仍引擒虎經朱雀航趣宮城，自南掖門而入。於是城內文武百司皆遁出，唯尚書僕射袁憲在殿內。尚書令江總、吏部尚書姚察、度支尚書袁權、前度支尚書王瑗、侍中王寬居省中。後主聞兵至，從宮人十餘出後堂景陽殿，將自投于井，袁憲侍側，苦諫不從，後閤舍人夏侯公韻又以身蔽井，後主與爭久之，方得入焉。及夜，為隋軍所執。景戌，晉王廣入據京城。
三月己巳，後主與王公百司發自建鄴，入于長安。隋仁壽四年十一月壬子，薨於洛陽，時年五十二。追贈大將軍，封長城縣公，謚曰煬，葬河南洛陽之芒山。